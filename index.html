<!DOCTYPE html>
<html>
  <head>
    <style type="text/css">
      html, body, #map-canvas { height: 100%; margin: 0; padding: 0;}
    </style>
  </head>
  <body>
    <div id="map-canvas"></div>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC6BtvgtpdgJPlBJfawFCgsz8NY0xOeBtE"></script>
    <script type="text/javascript" src="lib/jquery.js"></script>
    <script type="text/javascript" src="js/events.js"></script>
  <script type="text/javascript" src="js/trip.js"></script>
  <script type="text/javascript" src="js/map.js"></script>
<script type="text/javascript" src="js/gps.js"></script>
<script type="text/javascript" src="lib/geolocationmarker-compiled.js"></script>
    <script type="text/javascript">
      function initialize() {
        var trip = new ks.Trip('transam.json');

        var location = { lat: 40.397, lng: -100.644},
            map;
        if ("geolocation" in navigator) {
          navigator.geolocation.getCurrentPosition(function(position) {
            location = {
              lat: position.coords.latitude,
              lng: position.coords.longitude};

            map = new ks.Map("map-canvas", {
              center: location, zoom: 16
            })
            .trip(trip, {bounds: false, center: false, preload: true})
            .track(new ks.Gps(10000));
            trip.initialize(/TA(\d*)+Routes/);
          });
        } else {
          map = new ks.Map("map-canvas", {
            center: location, zoom: 5
          }).trip(trip, {bounds: false, center: true, preload: true});
          trip.initialize(/TA(\d*)+Routes/);
        }


      }
      google.maps.event.addDomListener(window, 'load', initialize);
    </script>
  </body>
</html>
